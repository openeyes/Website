<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>OpenEyes</title>
	
	<!-- CSS -->
	<link rel="stylesheet" href="../../css/openeyes.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="styles.css" type="text/css" media="screen" />

    <!--   Javascript  -->	
	<script language="JavaScript" src="../../scripts/elements.js" type="text/javascript"></script>
    <script language="JavaScript" src="../../scripts/ED_Drawing.js" type="text/javascript"></script>
    <script language="JavaScript" src="../../scripts/ED_Glaucoma.js" type="text/javascript"></script>	
	
    <script type="text/javascript">
    
        // Variables assigned to each drawing on this page
        var drawingEdit;
        var drawingDisplay;
                                    
        // Runs on page load
        function init()
        {
            // Get reference to the drawingEdit canvas
            var canvasEdit = document.getElementById('canvasEdit');
            
            // Create a drawing
            drawingEdit = new ED.Drawing(canvasEdit, ED.eye.Right, 'RPS');
            
            // Preload images
            drawingEdit.preLoadImagesFrom('../../graphics/');
            
            // Set focus to canvasEdit element
            canvasEdit.focus();
            
            // Wait for drawingEdit object to be ready before adding objects or drawingEdits
            drawingEdit.onLoaded = function()
            {
                drawingEdit.addDoodle('Gonioscopy');
                drawingEdit.deselectDoodles();
	            drawingEdit.drawAllDoodles();
            }

        }
        
        function popupSelect(_value)
        {
        	var select = document.getElementById('vanherrick');
        	select.value = _value;
        	hidePop('vanHerrickPNG');
        }
        
        function showPop(id)
		{
		   document.getElementById(id).style.visibility = "visible";
		}
		
		function hidePop(id)
		{
		   document.getElementById(id).style.visibility = "hidden";
		}
		
		function addToReport()
        {
        	// Get text from the applet and force into string type
			var text = drawingEdit.report();
		
			// Use a RegEx to remove final comma and space
			text = text.replace(/, +$/, '');
			
			// Get reference to report textarea
			var repText = document.getElementById('gonio');
			
			repText.value = text;
		}

	            
    </script>

</head>

<body onload="init();">
<div id="screen" align="center">
	<div id="content">

		<!-- Logo -->
		<img id="logo" src="../../images/OpenEyes_logo.png" align="left" alt="OpenEyes - an open source electronic patient record" />
		
		<!-- Navigation bar -->
		<div id="main_nav">
			<ul>
				<li><a id="home" href="../../index.html">Home</a></li>
				<li><a id="news" href="../../news.html">News</a></li>
				<li><a id="screenshots" href="../../screenshots.html">Screenshots</a></li>
				<li><a id="documentation" href="../../documentation.html">Documentation</a></li>
				<li><a id="contributors" href="../../contributors.html">Contributors</a></li>
				<li><a id="development_selected" href="../../development.html">Development</a></li>
				<li><a id="contact" href="../../contact.html">Contact us</a></li>
			</ul>
		</div>
		
		<!-- Element Title and Description -->
		<h2>Element title</h2>
		<div class="section">
			<h4>Description:</h4>
			<p>This element allows drawing and recording of gonioscopy findings. The angular extent of features such as angle recession, anterior synechiae, and angle new vessels is shown graphically, and extracted into text using the report button.</p>
			<p>The Van Herrick grade can be selected from the menu, or from the visual selector which uses diagrams from Paul Foster's paper as a guide.</p>
			<p>Status: <b>Alpha</b></p>
		</div>

		<!-- Edit mode section -->
		<div class="section" style="height:480px;" align="left">
			<h4>Edit mode:</h4>
						
			<!-- Right eye -->
			<div style ="width: 540px; float:left;">
			
				<p>Right gonioscopy:</p>
			
            	<!-- Doodle toolbar -->
				<div class="toolbar">
					<button class="imgbutton" class="imgbutton" disabled="true" id="moveToFrontRPS" title="Move to front" onclick="drawingEdit.moveToFront(); return false;" ><img src="../../graphics/moveToFront.gif"/></button>
	                <button class="imgbutton" disabled="true" id="moveToBackRPS" title="Move to back" onclick="drawingEdit.moveToBack(); return false;" ><img src="../../graphics/moveToBack.gif" /></button>
	                <button class="imgbutton" disabled="true" id="deleteRPS" title="Delete" onclick="drawingEdit.deleteDoodle(); return false;" ><img src="../../graphics/delete.gif" /></button>
	                <button class="imgbutton" disabled="true" id="lockRPS" title="Lock" onclick="drawingEdit.lock(); return false;" ><img src="../../graphics/lock.gif" /></button>
	                <button class="imgbutton" disabled="true" id="unlockRPS" title="Unlock" onclick="drawingEdit.unlock(); return false;" ><img src="../../graphics/unlock.gif" /></button>
	                <br />

                    <button class="imgbutton" title="Angle new vessels" onclick="drawingEdit.addDoodle('AngleNV'); return false;" ><img src="../../graphics/angleNV.gif" /></button>
                    <button class="imgbutton" title="Anterior synechiae" onclick="drawingEdit.addDoodle('AntSynech'); return false;" ><img src="../../graphics/antSynech.gif" /></button>
                    <button class="imgbutton" title="Angle recession" onclick="drawingEdit.addDoodle('AngleRecession'); return false;" ><img src="../../graphics/angleRecession.gif" /></button>
                    <button class="imgbutton" title="Pigmented meshwork" onclick="drawingEdit.addDoodle('PigmentedMesh'); return false;" ><img src="../../graphics/pigmentedMesh.gif" /></button>
                     <br />
   				</div>
   				
				<!-- Canvas -->
				<div style='float: left; width: 320px; height: 320px;'>
	                <canvas id="canvasEdit" width="300" height="300" tabindex="1"></canvas>
				</div>
   				
				<!-- Controls -->
				<div style='float: right; width: 220px; height: 320px;'>

					<table cellspacing="0" width="120" >
					<tbody>
						<tr>
							<td align="left" width="40%"><p class="lable" >Angle (Schaffer):</p></td>
							<td align="left" width="60%">
								<select name="shaffer" id="shaffer" >
						            <option value="0">NR</option>
						            <option value="0">0</option>
						            <option value="I">I</option>
						            <option value="II">II</option>
						            <option value="III">III</option>
						            <option value="IV">IV</option>
						        </select>
					        </td>
						</tr>	
						<tr>
							<td align="left" width="40%"><p class="lable" >Van Herrick:</p></td>
							<td align="left" width="60%">
								<select name="vanherrick" id="vanherrick" >
						            <option value="0">NR</option>
						            <option value="5">5%</option>
						            <option value="15">15%</option>
						            <option value="25">25%</option>
						            <option value="30">30%</option>
						            <option value="75">75%</option>
						            <option value="100">100%</option>						            
						        </select>
							</td>
						</tr>
						<tr>
							<td align="left" width="40%"><p class="lable" > </p></td>
							<td align="left" width="60%">
								<span style="position:relative; width:auto; background:#edf;">
									<span id='vanHerrickPNG' class="popup">
										<img usemap="#pickmap" width=225 src="../../graphics/gonioscopy.png" onMouseout="hidePop('vanHerrickPNG');"/>
										<map name="pickmap">
					                        <area style="cursor:pointer" shape="rect" coords="0,0,112,112" onclick="popupSelect(5);" />
					                        <area style="cursor:pointer" shape="rect" coords="0,112,112,224" onclick="popupSelect(15);" />
					                        <area style="cursor:pointer" shape="rect" coords="0,224,112,336" onclick="popupSelect(25);" />
					                        <area style="cursor:pointer" shape="rect" coords="112,0,225,112" onclick="popupSelect(30);" />
					                        <area style="cursor:pointer" shape="rect" coords="112,112,225,224" onclick="popupSelect(75);" />
					                        <area style="cursor:pointer" shape="rect" coords="112,224,225,336" onclick="popupSelect(100);" />						                    	</map>
									</span>
									<a href="javascript:void(0);" onMouseover="showPop('vanHerrickPNG');">Visual</a>
								</span>
					        </td>
						</tr>

						<tr>
							<td align="left"><p class="lable" >Text description:</p></td>
							<td align="left">
								<button class="actbutton" title="Creates a text description of the gonioscopy" onclick="addToReport(); return false;" >Report</button>
					        </td>
						</tr>
					</tbody>	
					</table>
					
					<textarea name="gonio" id="gonio"></textarea>
														
				</div>   				
   			
			</div>

			<!-- Left eye -->
			<div style ="width:540px; float:left;">
				<p>Left gonioscopy:</p>
			</div>
			
		<!-- End of Edit mode section -->
		</div>

		<!-- Display mode section -->
		<div class="section" style="height:270px;" align="left">
			<h4>Display mode:</h4>
			
			<!-- Right eye -->
			<div style ="width:540px; float:left;">
				<p>Right eye:</p>
				<div style="float:left; width: 220px; height: 220px;">

				</div>
				<div style="float:right; width: 320px; height: 220px;">

				</div>
			</div>
			
			<!-- Left eye -->
			<div style ="width:540px; float:left;">
				<p>Left eye:</p>					
			</div>				

		<!-- End of Display mode section -->
		</div>	

		<!-- Steering Group -->			
		<div class="section" align="left">
			<h4>Steering Group:</h4>
			<p>Glaucoma</p>
		</div>
		
		<!-- Blank Line -->
		<div class="section">
		</div>

	</div>
</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26543772-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
